<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
</head>
<body>
</body>
<script src="https://www.dropbox.com/static/api/dropbox-datastores-1.2-latest.js" type="text/javascript"></script>
<script src="./js/config.js" type="text/javascript"></script>
<script>
$(function() {

	var client = new Dropbox.Client({key: config.apiKey, token: config.token});

	// Try to finish OAuth authorization.
	client.authenticate({interactive: false}, function (error) {
	    if (error) {
	        alert('Authentication error: ' + error);
	    }
	});

	if (client.isAuthenticated()) {
		console.log('Authenticated!')
		getFileList();

	    // Client is authenticated. Display UI.
	} else {
		alert('Authentication failed');
	}

	function getFileList() {
	    client.readdir(config.imageDir, { deleted: false }, function(error, files, stats){
	        if(error){
	            alert('Error: ' + error); 
	        } else {
//	            console.log("readdir success", files, stats);
	            for (var i = 0; i < files.length; i++){
//	            	client.readFile(config.imageDir.files[i]);
					var path = config.imageDir +  '/' + files[i];
					console.log(client.thumbnailUrl(path);
	                console.log(files[i]);

	            } 
	        }
	        
	    });
	}
});



</script>
</html>
